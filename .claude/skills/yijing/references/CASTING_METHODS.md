# Casting Methods (筮法 Shì Fǎ)

*Generating hexagrams through structured randomness*

---

## Overview

The I Ching's power lies in the intersection of meaningful question, symbolic structure, and genuine randomness. The casting method bridges the querent's intention and the oracle's response.

Three primary methods are documented here:
1. **Yarrow Stalk Method** (蓍草法) — Traditional, asymmetric probabilities
2. **Three-Coin Method** (擲錢法) — Simplified, symmetric probabilities
3. **Seeded Generation** — Computational, reproducible

---

## I. The Yarrow Stalk Method (蓍草法 Shī Cǎo Fǎ)

The traditional method uses 50 yarrow stalks (Achillea millefolium). This is the method described in the Great Treatise (繫辭傳).

### Materials
- 50 yarrow stalks (or wooden dowels, chopsticks, etc.)
- A surface to work on
- Paper and pencil to record results

### Probability Distribution

| Value | Line Type | Probability | Fraction |
|-------|-----------|-------------|----------|
| 6 | Old Yin (changing) | 6.25% | 1/16 |
| 7 | Young Yang (stable) | 31.25% | 5/16 |
| 8 | Young Yin (stable) | 43.75% | 7/16 |
| 9 | Old Yang (changing) | 18.75% | 3/16 |

**Key Insight:** The yarrow method produces an asymmetric distribution. Old Yin (6) is the rarest outcome; Young Yin (8) is the most common. This means changing yang (9) is three times more likely than changing yin (6).

### The Process

Each line requires three operations with the stalks. One complete hexagram requires 18 operations total.

#### Preparation

1. **Set aside one stalk.** Start with 50 stalks; place one aside to represent the Grand Ultimate (太極 Tàijí). You now have 49 stalks for manipulation.

2. **Hold the bundle.** Take all 49 stalks in your hands. Focus on your question.

#### Operation 1 (of 3 per line)

**Step 1: Divide**
- Split the 49 stalks randomly into two bundles, one in each hand
- Place the right bundle on the table

**Step 2: Remove One**
- Take one stalk from the right bundle and place it between the fourth and fifth fingers of your left hand
- This represents the Human element between Heaven (left bundle) and Earth (right bundle)

**Step 3: Count Off Fours (Left Bundle)**
- With your right hand, remove stalks from the left bundle in groups of 4
- Continue until 1, 2, 3, or 4 stalks remain
- Place the remainder between the third and fourth fingers of your left hand

**Step 4: Count Off Fours (Right Bundle)**
- Repeat with the right bundle
- Place the remainder between the second and third fingers of your left hand

**Step 5: Count the Remainder**
- The stalks between your fingers will total either 5 or 9
- Set these aside

**Step 6: Record**
- If remainder is 5: count as 3
- If remainder is 9: count as 2
- (This is the traditional counting method)

#### Operation 2 (of 3 per line)

**Repeat the process** with the remaining stalks (now 44 or 40).

- Possible remainders: 4 or 8
- If remainder is 4: count as 3
- If remainder is 8: count as 2

#### Operation 3 (of 3 per line)

**Repeat again** with remaining stalks (now 40, 36, or 32).

- Possible remainders: 4 or 8
- If remainder is 4: count as 3
- If remainder is 8: count as 2

#### Determining the Line

**Add the three values** (each either 2 or 3):

| Sum | Line Value | Line Type |
|-----|------------|-----------|
| 6 (2+2+2) | 6 | Old Yin (changing) ▬✕▬ |
| 7 (2+2+3 or 2+3+2 or 3+2+2) | 7 | Young Yang (stable) ▬▬▬ |
| 8 (3+3+2 or 3+2+3 or 2+3+3) | 8 | Young Yin (stable) ▬ ▬ |
| 9 (3+3+3) | 9 | Old Yang (changing) ▬●▬ |

#### Complete the Hexagram

- Build the hexagram from bottom (line 1) to top (line 6)
- Record each line value (6, 7, 8, or 9) as you go
- After six lines, you have the complete hexagram

### Abbreviated Yarrow Method

For faster casting while maintaining yarrow probabilities:

1. **Use 16 stalks** (or 16 coins, tokens, etc.)
2. **For each line**, randomly divide into two groups
3. **Count the larger group**:
   - 13, 14, 15, or 16 → Old Yin (6)
   - 11 or 12 → Young Yang (7)
   - 9 or 10 → Young Yin (8)
   - 5, 6, 7, or 8 → Old Yang (9)

This preserves the 1:5:7:3 ratio of the traditional method.

---

## II. The Three-Coin Method (擲錢法 Zhí Qián Fǎ)

The simplified method, developed during the Tang Dynasty, uses three coins tossed simultaneously.

### Materials
- Three coins of any denomination
- Paper and pencil

### Probability Distribution

| Value | Line Type | Probability |
|-------|-----------|-------------|
| 6 | Old Yin (changing) | 12.5% (1/8) |
| 7 | Young Yang (stable) | 37.5% (3/8) |
| 8 | Young Yin (stable) | 37.5% (3/8) |
| 9 | Old Yang (changing) | 12.5% (1/8) |

**Key Difference from Yarrow:** Old Yin and Old Yang are equally likely (1/8 each), and Young Yang and Young Yin are equally likely (3/8 each). This differs significantly from yarrow's asymmetric distribution.

### Value Assignment (Traditional)

**Heads = 3, Tails = 2**

| Toss Result | Sum | Line Value |
|-------------|-----|------------|
| 3 Tails (TTT) | 6 | Old Yin ▬✕▬ |
| 2 Tails, 1 Head (TTH, THT, HTT) | 7 | Young Yang ▬▬▬ |
| 2 Heads, 1 Tail (HHT, HTH, THH) | 8 | Young Yin ▬ ▬ |
| 3 Heads (HHH) | 9 | Old Yang ▬●▬ |

### Alternative Assignment

Some practitioners use the reverse:

**Heads = 2, Tails = 3**

This produces the same probabilities but reverses which coin side corresponds to which energy. Choose one system and use it consistently.

### Chinese Coin Method

Traditional Chinese coins have:
- **Inscribed side** (with characters): Yin, value 2
- **Blank side**: Yang, value 3

This follows the principle that inscription (form, mark) is yin while blankness (potential, unmarked) is yang.

### The Process

1. **Formulate your question** clearly
2. **Hold the three coins** in cupped hands
3. **Shake and release** onto a flat surface
4. **Count the value** (sum of the three coins)
5. **Record the line** (6, 7, 8, or 9)
6. **Repeat** for each of the six lines
7. **Build from bottom to top**

---

## III. Seeded Generation Method

For computational casting that produces reproducible results from a seed value.

### Principle

The question or a keyword is hashed to produce line values, maintaining mathematical validity while honoring the question's essence.

### Algorithm (Yarrow Probabilities)

```python
import hashlib

def cast_hexagram_yarrow(question: str, salt: str = "") -> list[int]:
    """
    Generate a hexagram with yarrow stalk probabilities.

    Probability distribution:
    - 6 (Old Yin):   1/16 = 6.25%
    - 7 (Young Yang): 5/16 = 31.25%
    - 8 (Young Yin):  7/16 = 43.75%
    - 9 (Old Yang):   3/16 = 18.75%
    """
    combined = question + salt
    hash_bytes = hashlib.sha256(combined.encode()).digest()

    lines = []
    for i in range(6):
        # Use 2 bytes per line for better distribution
        value = (hash_bytes[i*2] << 8) | hash_bytes[i*2 + 1]
        normalized = value / 65536.0  # 0 to 1

        # Map to yarrow probabilities (1/16, 5/16, 7/16, 3/16)
        if normalized < 1/16:        # 0.0625
            lines.append(6)
        elif normalized < 6/16:      # 0.375
            lines.append(7)
        elif normalized < 13/16:     # 0.8125
            lines.append(8)
        else:                        # remaining 3/16
            lines.append(9)

    return lines
```

### Algorithm (Coin Probabilities)

```python
def cast_hexagram_coins(question: str, salt: str = "") -> list[int]:
    """
    Generate a hexagram with three-coin probabilities.

    Probability distribution:
    - 6 (Old Yin):   1/8 = 12.5%
    - 7 (Young Yang): 3/8 = 37.5%
    - 8 (Young Yin):  3/8 = 37.5%
    - 9 (Old Yang):   1/8 = 12.5%
    """
    combined = question + salt
    hash_bytes = hashlib.sha256(combined.encode()).digest()

    lines = []
    for i in range(6):
        value = hash_bytes[i] / 256.0  # 0 to 1

        if value < 1/8:              # Old Yin
            lines.append(6)
        elif value < 4/8:            # Young Yang (1/8 + 3/8)
            lines.append(7)
        elif value < 7/8:            # Young Yin (4/8 + 3/8)
            lines.append(8)
        else:                        # Old Yang
            lines.append(9)

    return lines
```

### Usage

```bash
# Using the skill's script
python3 .claude/skills/yijing/scripts/cast_hexagram.py "Should I change jobs?"
python3 .claude/skills/yijing/scripts/cast_hexagram.py --method yarrow "What is the nature of this situation?"
python3 .claude/skills/yijing/scripts/cast_hexagram.py --method coins "Will the project succeed?"
```

---

## IV. Preparing for a Casting

### The Question

**Good questions are:**
- Open-ended (not yes/no)
- Specific to a situation
- Focused on the querent's role
- Time-bound when relevant

**Examples of good questions:**
- "What is the nature of my current work situation?"
- "What should I understand about this relationship?"
- "What approach should I take to this problem?"
- "What should I be aware of in the coming month?"

**Less effective questions:**
- "Should I take the job or not?" (too binary)
- "What will happen?" (too passive; where is the querent?)
- "Is X a good person?" (not about the querent's situation)

### Mental Preparation

Before casting:

1. **Clarify the question** — Write it down
2. **Center yourself** — Breathe, become still
3. **Release attachment** — Don't cast hoping for a particular answer
4. **Invoke receptivity** — Open to what the oracle offers

### Physical Setting

Traditional recommendations:
- Clean, quiet space
- Facing south (traditional) or a personally meaningful direction
- Incense or candle (optional, for focus)
- The question written on paper before you

---

## V. Recording the Hexagram

### Notation

Record lines from bottom to top with their values:

```
Line 6:  ▬ ▬  (8)
Line 5:  ▬▬▬  (7)
Line 4:  ▬●▬  (9) ← moving
Line 3:  ▬▬▬  (7)
Line 2:  ▬✕▬  (6) ← moving
Line 1:  ▬ ▬  (8)
```

### Identifying the Hexagram

1. **Separate into trigrams**
   - Lines 1-3: Lower trigram
   - Lines 4-6: Upper trigram

2. **Look up the hexagram** using the trigram matrix or table

3. **Note moving lines** (6s and 9s)

4. **Derive the relating hexagram** by changing moving lines

---

## VI. Comparison of Methods

| Aspect | Yarrow | Coins | Seeded |
|--------|--------|-------|--------|
| Time required | 15-20 min | 2-3 min | Instant |
| Physical materials | Yes | Yes | No |
| True randomness | Yes | Yes | Deterministic |
| Reproducible | No | No | Yes |
| Changing line probability | Asymmetric (3:1 yang:yin) | Symmetric (1:1) | Choice |
| Ritual weight | High | Medium | Low |
| Traditional | Yes (oldest) | Yes (Tang dynasty) | No |

### When to Use Each

**Yarrow:** For serious questions, ritual settings, when the process itself is part of the practice

**Coins:** For daily consultation, quick guidance, practical questions

**Seeded:** For reproducible readings, computational analysis, when physical casting isn't possible

---

## VII. The Mathematics

### Yarrow Probability Derivation

In the yarrow method:
- First division can produce remainder of 5 or 9
- Second and third divisions can produce remainder of 4 or 8
- The probability of getting a 3 in first division: 1/4 (only when remainder is 5)
- The probability of getting a 3 in subsequent divisions: 1/2

This produces the 1:5:7:3 ratio for 6:7:8:9.

### Why the Asymmetry Matters

With yarrow:
- Old Yang (9) is 3× more likely than Old Yin (6)
- Stable Yin (8) is the most common outcome
- Stable Yang (7) appears about 5× as often as Old Yin

This reflects a cosmological view where:
- Yin is the natural ground state (8 is most common)
- Yang assertion requires more energy (7 less common than 8)
- Change requires extremity, but yang changes more readily than yin

---

## VIII. The Asymmetry is the Teaching

**Yarrow Stalk Probabilities (1:5:7:3) visualize cosmological bias:**

```
Old Yin (6)    █                           6.25%  ← Rarest: transformation from depths
Young Yang (7) █████                       31.25% ← Yang assertion costs energy
Young Yin (8)  ███████                     43.75% ← Yin is the ground state
Old Yang (9)   ███                         18.75% ← Yang changes 3× more readily than yin
               └──────────────────────────────────┘
                0%                              50%
```

**Three-Coin Probabilities (1:3:3:1) — Western Symmetry:**

```
Old Yin (6)    ██                          12.5%  ← Equal change probability
Young Yang (7) ██████                      37.5%  ← Symmetric
Young Yin (8)  ██████                      37.5%  ← Symmetric
Old Yang (9)   ██                          12.5%  ← Equal change probability
               └──────────────────────────────────┘
                0%                              50%
```

### The Cosmological Teaching

**Why is yin more likely?** Yin is receptive, therefore *more prevalent*. The universe rests more than it acts. The ocean is still more than it storms. To exist is, by default, to receive.

**Why does yang change more readily?** Yang is active, therefore *less stable*. What asserts itself expends itself. The candle that burns consumes. To act is to transform.

**Why is transformation from yin so rare?** To transform from yin requires reaching the absolute nadir (6)—the deepest possible receptivity becoming its opposite. This is the rarest event: stillness so complete it becomes movement. The winter solstice. The seed cracking open. The sleeper waking.

**The math encodes the *energetic cost* of change:**
- Yarrow says: "Change from yang costs less than change from yin"
- Coins say: "All change costs the same"

**Three-Coin Method is democracy; Yarrow Method is cosmology.**

Choose coins for quick consultation where all outcomes feel equally possible.
Choose yarrow when you want the oracle to weight your question with three millennia of cosmological understanding.

### Visual in CLI Output

When casting with the script, you can see which cosmology you're invoking:

```
╔════════════════════════════════════════════════════════════╗
║  Method: yarrow                                            ║
║  ┌─────────────────────────────────────────────────────┐   ║
║  │ 6 █░░░░░░░  7 █████░░░  8 ███████░  9 ███░░░░░     │   ║
║  │   6.25%      31.25%      43.75%      18.75%        │   ║
║  └─────────────────────────────────────────────────────┘   ║
╚════════════════════════════════════════════════════════════╝
```

This histogram reminds: *you are not rolling dice—you are invoking a cosmological frame*.

---

## IX. Oracle Refusal: When the Changes Decline to Answer

Hexagram 4 (蒙 Méng, Youthful Folly) contains a teaching about *importunity*:

> 初筮告，再三瀆，瀆則不告。
> "At the first oracle I inform. Repeated asking is importunity. If importunate, I give no information."

### When the Oracle Should Refuse

The oracle speaks once to a question. Repeated asking shows:
- Doubt in the first answer
- Desire for a different answer
- Failure to sit with the teaching

### Implementation

The script can detect importunity patterns:

```python
# Questions asked within 24 hours with high similarity → refuse
# Empty or trivial questions ("test", "asdf") → refuse
# Questions ending in "right?" or "correct?" → refuse (seeking confirmation, not guidance)
```

When the oracle refuses, it returns Hexagram 4 with the message:

> *The Changes have already spoken to this question.*
> *If the answer was unclear, contemplate it longer.*
> *If the answer was unwelcome, that is your teaching.*
> *Return when you have a new question—not a repeated demand.*

### Graceful Degradation

If the querent asks about 未濟 (Before Completion) while already standing in a state of 未濟, the oracle might respond:

> *You stand at the crossing you asked about.*
> *The oracle can only mirror—live the question, don't repeat it.*

---

*大衍之數五十，其用四十有九。*
*The number of the great expansion is fifty. Of these, forty-nine are used.*
— 繫辭傳 (The Great Treatise)
